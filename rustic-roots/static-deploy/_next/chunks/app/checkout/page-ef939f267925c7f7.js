(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{1966:(e,s,a)=>{Promise.resolve().then(a.bind(a,9301))},5695:(e,s,a)=>{"use strict";var t=a(8999);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}})},9301:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var t=a(5155),r=a(2115),i=a(2108),l=a(5695),n=a(6766),d=a(4615),c=a(8088);function o(){var e;let{data:s,status:a}=(0,i.useSession)(),{state:o,dispatch:m}=(0,c._)(),u=(0,l.useRouter)(),[x,h]=(0,r.useState)(!1),[g,p]=(0,r.useState)({email:(null==s||null==(e=s.user)?void 0:e.email)||"",firstName:"",lastName:"",address:"",city:"",state:"",zipCode:"",country:"United States"});(0,r.useEffect)(()=>{if("loading"!==a){if(0===o.items.length)return void u.push("/cart");if(!s)return void u.push("/auth/signin?redirect=/checkout")}},[s,a,o.items.length,u]);let f=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),y=e=>{p({...g,[e.target.name]:e.target.value})},b=async e=>{e.preventDefault(),h(!0);try{let e={total:1.08*o.total,items:o.items.map(e=>({productId:e.id,quantity:e.quantity,price:e.price})),shippingAddress:{firstName:g.firstName,lastName:g.lastName,address:g.address,city:g.city,state:g.state,zipCode:g.zipCode,country:g.country}},s=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){let e=await s.json();m({type:"CLEAR_CART"}),u.push("/orders/".concat(e.id))}else throw Error("Failed to create order")}catch(e){console.error("Checkout error:",e),alert("An error occurred during checkout. Please try again.")}finally{h(!1)}};if("loading"===a)return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(d.default,{}),(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"text-xl",children:"Loading..."})})]});if(0===o.items.length||!s)return null;let j=o.total,N=.08*j;return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(d.default,{}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Checkout"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Shipping Information"}),(0,t.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:g.email,onChange:y,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First Name"}),(0,t.jsx)("input",{type:"text",id:"firstName",name:"firstName",value:g.firstName,onChange:y,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),(0,t.jsx)("input",{type:"text",id:"lastName",name:"lastName",value:g.lastName,onChange:y,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Address"}),(0,t.jsx)("input",{type:"text",id:"address",name:"address",value:g.address,onChange:y,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:"City"}),(0,t.jsx)("input",{type:"text",id:"city",name:"city",value:g.city,onChange:y,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700",children:"State"}),(0,t.jsx)("input",{type:"text",id:"state",name:"state",value:g.state,onChange:y,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"zipCode",className:"block text-sm font-medium text-gray-700",children:"ZIP Code"}),(0,t.jsx)("input",{type:"text",id:"zipCode",name:"zipCode",value:g.zipCode,onChange:y,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700",children:"Country"}),(0,t.jsxs)("select",{id:"country",name:"country",value:g.country,onChange:y,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-amber-500",children:[(0,t.jsx)("option",{value:"United States",children:"United States"}),(0,t.jsx)("option",{value:"Canada",children:"Canada"})]})]})]}),(0,t.jsx)("div",{className:"pt-6",children:(0,t.jsx)("button",{type:"submit",disabled:x,className:"w-full bg-amber-800 text-white px-6 py-3 rounded-md font-medium hover:bg-amber-900 transition-colors disabled:bg-gray-400",children:x?"Processing...":"Place Order"})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Order Summary"}),(0,t.jsx)("div",{className:"space-y-4",children:o.items.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(n.default,{src:e.image,alt:e.name,width:64,height:64,className:"w-16 h-16 rounded-md object-cover"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsxs)("p",{className:"text-gray-500",children:["Quantity: ",e.quantity]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsx)("p",{className:"font-medium text-gray-900",children:f(e.price*e.quantity)})})]},e.id))}),(0,t.jsxs)("div",{className:"border-t border-gray-200 mt-6 pt-6 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,t.jsx)("span",{className:"font-medium",children:f(j)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Shipping"}),(0,t.jsx)("span",{className:"font-medium",children:"Free"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Tax"}),(0,t.jsx)("span",{className:"font-medium",children:f(N)})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-2",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-lg font-medium text-gray-900",children:"Total"}),(0,t.jsx)("span",{className:"text-lg font-bold text-amber-800",children:f(j+N)})]})})]}),(0,t.jsxs)("div",{className:"mt-6 text-sm text-gray-500",children:[(0,t.jsx)("p",{children:"• Free shipping on all orders"}),(0,t.jsx)("p",{children:"• Secure payment processing"}),(0,t.jsx)("p",{children:"• 30-day return policy"})]})]})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[108,874,766,615,441,684,358],()=>s(1966)),_N_E=e.O()}]);